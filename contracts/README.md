# ğŸ± TON Cat Lottery - æ™ºèƒ½åˆç´„

TON Cat Lottery æ™ºèƒ½åˆç´„å¯¦ç¾ï¼Œä½¿ç”¨ Tact èªè¨€é–‹ç™¼ã€‚

## ğŸ“¦ åŠŸèƒ½ç‰¹è‰²

- âœ… **åƒåŠ æŠ½ç** - ç”¨æˆ¶æ”¯ä»˜ TON åƒèˆ‡æŠ½ç
- âœ… **éš¨æ©ŸæŠ½ç** - åŸºæ–¼å€å¡Šå“ˆå¸Œçš„å…¬å¹³éš¨æ©Ÿæ©Ÿåˆ¶
- âœ… **NFT ç™¼é€** - è‡ªå‹•ç™¼é€è²“å’ª NFT çµ¦ä¸­çè€…
- âœ… **è¼ªæ¬¡ç®¡ç†** - æ”¯æ´å¤šè¼ªæŠ½ç
- âœ… **è³‡é‡‘ç®¡ç†** - å®‰å…¨çš„è³‡é‡‘æå–æ©Ÿåˆ¶
- âœ… **äº‹ä»¶è¨˜éŒ„** - å®Œæ•´çš„éˆä¸Šäº‹ä»¶æ—¥èªŒ

## ğŸ› ï¸ ç’°å¢ƒéœ€æ±‚

```bash
Node.js >= 18.0.0
npm >= 8.0.0
```

## ğŸš€ å¿«é€Ÿé–‹å§‹

### 1ï¸âƒ£ å®‰è£ä¾è³´

```bash
cd contracts
npm install
```

### 2ï¸âƒ£ ç·¨è­¯åˆç´„

```bash
npm run build
```

### 3ï¸âƒ£ é©—è­‰ç·¨è­¯çµæœ

```bash
npm run verify
```

### 4ï¸âƒ£ é‹è¡Œæ¸¬è©¦

```bash
npm run test
```

### 5ï¸âƒ£ éƒ¨ç½²åˆ°æ¸¬è©¦ç¶²

```bash
npm run deploy:testnet
```

## ğŸ“‹ è©³ç´°æŒ‡ä»¤èªªæ˜

### å®‰è£å’Œè¨­ç½®

```bash
# å®‰è£æ‰€æœ‰ä¾è³´
npm install

# Tact CLI å·²åŒ…å«åœ¨é …ç›®ä¾è³´ä¸­ï¼Œç„¡éœ€å…¨å±€å®‰è£

# é©—è­‰ç·¨è­¯å™¨
npx tact --version
```

### ç·¨è­¯åˆç´„

```bash
# ç·¨è­¯ Tact åˆç´„
npm run build

# ç·¨è­¯å¾Œçš„æ–‡ä»¶ä½æ–¼ build/ ç›®éŒ„
ls build/
```

### æ¸¬è©¦åˆç´„

```bash
# é‹è¡Œä¸»è¦æ¸¬è©¦
npm run test

# é‹è¡Œæ‰€æœ‰æ¸¬è©¦
npm run test:all

# é‹è¡Œæ¸¬è©¦ä¸¦è§€å¯Ÿè®ŠåŒ–
npm run test:watch

# é©—è­‰åˆç´„ç·¨è­¯çµæœ
npm run verify
```

### é©—è­‰ç·¨è­¯

```bash
# æª¢æŸ¥ç·¨è­¯çµæœå’Œåˆç´„åŠŸèƒ½
npm run verify

# æ‰‹å‹•æª¢æŸ¥ç·¨è­¯è¼¸å‡º
ls build/
cat build/CatLottery_CatLottery.abi
```

### éƒ¨ç½²åˆç´„

#### éƒ¨ç½²åˆ°æ¸¬è©¦ç¶²

```bash
# ä½¿ç”¨è…³æœ¬éƒ¨ç½²
npm run deploy:testnet

# æ³¨æ„ï¼šéœ€è¦å…ˆé…ç½®éŒ¢åŒ…åŠ©è¨˜è©
```

#### éƒ¨ç½²åˆ°ä¸»ç¶²

```bash
npm run deploy:mainnet
```

#### è‡ªå®šç¾©éƒ¨ç½²åƒæ•¸

å‰µå»º `.env` æ–‡ä»¶ï¼š

```bash
# .env
DEPLOYER_MNEMONIC="your wallet mnemonic words here"
ENTRY_FEE=100000000  # 0.1 TON in nanoTON
MAX_PARTICIPANTS=10
NETWORK=testnet
```

ç„¶å¾Œéƒ¨ç½²ï¼š

```bash
npm run deploy:testnet
```

### èˆ‡åˆç´„äº’å‹•

```bash
# é€£æ¥åˆ°å·²éƒ¨ç½²çš„åˆç´„
npx tsx scripts/interact.ts <CONTRACT_ADDRESS>

# ç¯„ä¾‹
npx tsx scripts/interact.ts EQC_CONTRACT_ADDRESS_HERE
```

## ğŸ§ª æ¸¬è©¦è¦†è“‹ç¯„åœ

ç•¶å‰æ¸¬è©¦å¥—ä»¶åŒ…å«åŸºæœ¬åŠŸèƒ½æ¸¬è©¦ï¼š

### âœ… å·²æ¸¬è©¦åŠŸèƒ½

- **åˆç´„éƒ¨ç½²èˆ‡åˆå§‹åŒ–** - é©—è­‰åˆç´„æ­£ç¢ºéƒ¨ç½²å’Œåƒæ•¸è¨­ç½®
- **ç‹€æ…‹æŸ¥è©¢** - æ¸¬è©¦ `getContractInfo()` ç­‰æŸ¥è©¢æ–¹æ³•
- **é¤˜é¡æª¢æŸ¥** - é©—è­‰åˆç´„é¤˜é¡ç®¡ç†
- **é‚Šç•Œæ¢ä»¶** - æ¸¬è©¦ä¸å­˜åœ¨çš„åƒèˆ‡è€…å’Œä¸­çè¨˜éŒ„æŸ¥è©¢

### ğŸš§ å¾…æ“´å±•æ¸¬è©¦

- åƒåŠ æŠ½çæµç¨‹æ¸¬è©¦
- æŠ½çåŠŸèƒ½æ¸¬è©¦
- æ¬Šé™ç®¡ç†æ¸¬è©¦
- NFT ç™¼é€æ¸¬è©¦
- éŒ¯èª¤è™•ç†æ¸¬è©¦

## ğŸ“Š åˆç´„æ¶æ§‹

```
CatLottery.tact
â”œâ”€â”€ ç‹€æ…‹è®Šé‡
â”‚   â”œâ”€â”€ owner           # åˆç´„æ“æœ‰è€…
â”‚   â”œâ”€â”€ entryFee        # åƒèˆ‡è²»ç”¨
â”‚   â”œâ”€â”€ maxParticipants # æœ€å¤§åƒèˆ‡äººæ•¸
â”‚   â”œâ”€â”€ participants    # åƒèˆ‡è€…æ˜ å°„
â”‚   â””â”€â”€ winners         # ä¸­çè¨˜éŒ„
â”œâ”€â”€ æ ¸å¿ƒåŠŸèƒ½
â”‚   â”œâ”€â”€ join()          # åƒåŠ æŠ½ç
â”‚   â”œâ”€â”€ drawWinner()    # é€²è¡ŒæŠ½ç
â”‚   â””â”€â”€ sendNFT()       # ç™¼é€ NFT
â”œâ”€â”€ ç®¡ç†åŠŸèƒ½
â”‚   â”œâ”€â”€ setNFTContract  # è¨­å®š NFT åˆç´„
â”‚   â”œâ”€â”€ startNewRound   # é–‹å§‹æ–°è¼ªæ¬¡
â”‚   â””â”€â”€ withdraw        # æå–è³‡é‡‘
â””â”€â”€ æŸ¥è©¢åŠŸèƒ½
    â”œâ”€â”€ getContractInfo # åˆç´„ç‹€æ…‹
    â”œâ”€â”€ getParticipant  # åƒèˆ‡è€…è³‡è¨Š
    â””â”€â”€ getWinner       # ä¸­çè¨˜éŒ„
```

## ğŸ”§ è‡ªå®šç¾©é…ç½®

### ä¿®æ”¹åˆç´„åƒæ•¸

åœ¨ `scripts/deploy.ts` ä¸­ä¿®æ”¹ï¼š

```typescript
const ENTRY_FEE = toNano('0.5'); // åƒèˆ‡è²»ç”¨
const MAX_PARTICIPANTS = 20; // æœ€å¤§åƒèˆ‡äººæ•¸
```

### ä¿®æ”¹éš¨æ©Ÿæ•¸ç®—æ³•

åœ¨ `CatLottery.tact` ä¸­ä¿®æ”¹ `drawWinner()` æ–¹æ³•çš„éš¨æ©Ÿæ•¸ç”Ÿæˆé‚è¼¯ã€‚

## ğŸš¨ å®‰å…¨æ³¨æ„äº‹é …

1. **éš¨æ©Ÿæ•¸å®‰å…¨æ€§** - ç›®å‰ä½¿ç”¨å€å¡Šå“ˆå¸Œï¼Œåœ¨ç”Ÿç”¢ç’°å¢ƒå»ºè­°ä½¿ç”¨æ›´å®‰å…¨çš„éš¨æ©Ÿæº
2. **æ¬Šé™ç®¡ç†** - ç¢ºä¿éƒ¨ç½²è€…éŒ¢åŒ…å®‰å…¨
3. **è³‡é‡‘å®‰å…¨** - å®šæœŸæå–åˆç´„è³‡é‡‘
4. **NFT åˆç´„é©—è­‰** - ç¢ºä¿ NFT åˆç´„åœ°å€æ­£ç¢º

## ğŸ“ˆ Gas è²»ç”¨ä¼°ç®—

| æ“ä½œ     | é ä¼° Gas è²»ç”¨ |
| -------- | ------------- |
| éƒ¨ç½²åˆç´„ | ~1.0 TON      |
| åƒåŠ æŠ½ç | ~0.05 TON     |
| é€²è¡ŒæŠ½ç | ~0.1 TON      |
| NFT ç™¼é€ | ~0.05 TON     |
| ç®¡ç†æ“ä½œ | ~0.05 TON     |

## ğŸ› æ•…éšœæ’é™¤

### ç·¨è­¯éŒ¯èª¤

```bash
# æ¸…ç†ç·¨è­¯æ–‡ä»¶
rm -rf build/
npm run build
```

### æ¸¬è©¦å¤±æ•—

```bash
# æª¢æŸ¥ä¾è³´
npm install
npm run test
```

### éƒ¨ç½²å¤±æ•—

```bash
# æª¢æŸ¥ç¶²è·¯é€£æ¥
ping testnet.toncenter.com

# æª¢æŸ¥éŒ¢åŒ…é¤˜é¡
# ç¢ºä¿æœ‰è¶³å¤ çš„ TON æ”¯ä»˜éƒ¨ç½²è²»ç”¨
```